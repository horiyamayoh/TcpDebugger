# TCP/IP u İŒv

## 1. Tv

### 1.1 Ú“I
TCP/UDPÊMÌƒeXgEfobOsß‚Ìuñ‹Ÿ‚B
İ’t@Cx[XÅƒViIsÂ”\ÅAoIÉÚ‘Ô‚mFÅ‚GUIB

### 1.2 sÂ‹
- **OS**: Windows 10/11
- **sÂ‹**: PowerShell 5.1È~iÇ‰CXg[svj
- **GUI**: Windows Forms (WinForms)BWPFPoCxÌƒIvVÆ‚AÅ‚WinFormsÅ’ñ‹ŸB
- **O**: .NET FrameworkiWindowsWÚj

### 1.3 İŒvj
- **M` (Send-First Architecture)**: {c[Í‘MÅdvAVbgMf[^Ø‘Ö‚ÅANVÅsUI^APIñ‹Ÿ‚BMf[^ÍŠmFpÌÅ\É—ß‚B
- **w (Test-Oriented)**: ÄŒÌViIÆƒf[^oNÅ‚Ì“dÇ—AÆÒ‚Ép^[Ø‚Ö‚é‚±Æ‚dB
- **XP[uÇ— (Scalable Instance Management)**: 10?20ÈÌ’ÊMCX^X_O[vE^OÅAÑ‚ÆˆêŠ‡ñ‹Ÿ‚B
- **1tH_=1CX^X**: ×‚Ä‚Ì’ÊMCX^XÍƒtH_PÊ‚ÅŠÇ—Aİ’EViIEOSÉ“Æ—B
- **ffx (Diagnostic Support)**: lbg[NaÊŠmFA|[gJ`FbNA[eBOmFñ‹Ÿ‚Aã‚°ÌŒË˜fç‚·B

### 1.4 x`}[NiUdome Socket Debuggerj
> Jñ‚¨‚ÑŒê—˜pÔ‚ÉŠÃ‚Ê“IÈ‹@\rBÚ×dlsÈ‰ÓÍÜ‚ŞB

| Ï“_ | Udome Socket Debugger () | {İŒvÌ—DÊ |
| --- | --- | --- |
| Ú‘ | P or \PbgÌè“®Ø‘ | 10?20È_O[vÅ“^pAoNÂ”\ |
| M | eLXg/HEXÍ{^M | f[^oNÅƒev[gÖ‚ANbNM |
| ViI | XNvg/}N | CSVViI{PowerShellgAEE[vÈŒLq |
| M\ | Ú×ƒO^oCi\ | VvÈŠmF\ASend-FirstÉÅ“K |
| ffx | È‚ | Ping/Port/Route`FbNAANV |
| UI/UX | Ä—pfobKUI | NCbNMA_r[AVOANVÅw |

{İŒvÍŠiÓ‚Æ‚è“®fobOvfJo[Â‚ÂAÆ‚ÄdvÈuÊƒCX^XÇ—vuMev[gÌ‘Ø‘Övu\/ffT|[gvÇ‰é‚±Æ‚ÅA[UreBÆ‹@\Ì‘oÅé‚±Æ‚Ú•WÆ‚B

### 1.5 ÊŒİŠÆ‚È‚Ì“I@\
1. **f[^oN{NbNM**: æ‚­gdJeSÊ‚É“o^Ahbv_EIÜ‚Íƒ{^1NbNÅƒVbgMB
2. **_r[Ç—**: CX^Xupr~^OvÅA20Ú‘KÍ‚Å‚í‚¸BO[vêŠ‡MÄÚ‘NbNB
3. **ViIg**: CSV`ÌƒViILqAPowerShellXNvgAgAEE[vÈŒÉ‹LqÅ‚dgİB
4. **ZbgAbvff**: Ping/Port/Route_AÎ{Å’ñ¦BÚ‘Ì–B
5. **Mf[^p**: ViIÅMf[^ÏÆ‚Ä•ÛAñ‘—MÉ–ßİ‰Â”\BIÈ“dB
6. **1tH_=1CX^X**: ×‚Ä‚Ìİ’EViIEOtH_PÊ‚ÅŠSÆ—BRs[ÅŠÂ‹Â”\B

---

## 2. @\v

### 2.1 ÊM@\
- **TCPÊM**: NCAg/T[o[[hÎ‰
- **UDPÊM**: M/MÎ‰
- **Ú‘**: Ù‚È‚IP:PortÌ‘gİí‚¹Å•CX^Xğ“¯N
- **Ú‘Ç—**: Ú‘/Ø’fÌAÄÚ‘@\

### 2.2 dM@\iCX^XPÊ‚Å“Æ—j
eÊMCX^XÍ“ÆÌƒf[^oNEMİ’EMÛACX^XÆ‚ÍŠSÉ•ê‚½Ô‚Å“ì‚·B
- **f[^oNÇ—**: CX^XtH_CSVÅ’`OtdZbgÇ‚İİAJeS^OÅB
- **NbNM**: hbv_EIÜ‚Íƒ{^1ÅA**Iğ’†‚ÌƒCX^X**Ö‘MÅ‚Send-First UIB
- **Ê‚È‘M**: eLXgAHEXAt@CMAev[gWJAÏßİB×‚ÄƒCX^XÆ‚É“Æ—ÏXR[vÅB
- **M**: ViIÜ‚Íƒob`Å‚Ì˜AMBCX^XÖ‚ÌˆêŠ‡MÂ”\AeCX^XÍ“Æ—^C~OEÔ‚ÅsB
- **M\iÅj**: MÊ‚ÍƒCX^XÆ‚ÉƒT}ÆƒXe[^XÌ‚İ‚\B
- **Mf[^p**: Mf[^ÏÆ‚Ä•ÛAñ‘—Mf[^É–ßİ‰Â”\BIÈ“dB
- **GR[fBO**: ASCII, UTF-8, Shift-JIS, oCi(HEX)Î‰BCX^XÆ‚Éİ’Â”\B

### 2.3 ViI@\iCX^XPÊ‚Å“Æ—sj
eCX^XÍ“ÆÌƒViIt@CACX^XÌƒViIsÔ‚É‰eé‚±Æ‚È‚ì‚·B
- **ViIt@C**: CX^XtH_CSV`ÅƒViI`
- **Ò‹@**: Ô‘Ò‹@AMÒ‹@BÒ‹@Ô‚ÍŠeCX^XÅ“Æ—Ç—B
- ****: Mf[^ÉŠÃ‚BEÏÍƒCX^XXR[vÅ•]B
- **[v**: JÔ‚sB[vJE^ÍƒCX^XÆ‚É“Æ—B
- **Ï@\**: Mf[^ÏÆ‚Ä•ÛAñ‘—MÉ“IÉ–ßİBÏXR[vÍƒCX^XÉ•Â‚ACX^XÆ‹LÈ‚B
- **XNvgAg**: JX^PowerShellWbNÄ‚ÑoAGÈUé•‘ÈŒÉ‹LqBXNvgÉ‚ÍŒİ‚ÌƒCX^XReLXgnB
- **O[vM**: CX^XÖˆêŠ‡MwÂ”\AÛ‚Ì‘MÍŠeCX^XÆ—ÄsB

### 2.4 g@\iCX^XPÊ‚Å“Æ—İ’j
- ****: p^[MÌÔMB[ÍƒCX^XÆ‚É’`AÆ—B
- **IXV**: ev[gx[XÌ“diÏujBÏEV[PXÔÍƒCX^XXR[vÅŠÇ—B
- **JX^XNvg**: PowerShellXNvgÉ‚gBCX^XReLXgÆ‚Äó‚¯B
- **vOC@\**: OPSXNvgÌ“Ç‚İİBCX^XÆ‚ÉˆÙ‚È‚vOCZbgKpÂ”\B

### 2.5 GUI@\
- **Ú‘ê——**: ANeBuÈÚ‘Ìˆê——\BeCX^XÌÔ‚Â•Ê‚É•\B
- **Xe[^X\iFj**: eÚ‘ÌÔ‚A^CÉF\i=Ú‘A=Ø’fA=G[AO[=Ú‘jBWinForms`DataGridView`Ü‚`ListView`ÅŠesEJ[hÌ”wiFğ“®“IÉ•ÏXAoIÉÔ‚cÂ”\BCX^XPÊ‚Å“Æ—B
- **Or[A**: MÌ•\BICX^XÌƒOtB^\Â”\B
- **İ’pl**: Ú‘İ’AViIIBIğ’†‚ÌƒCX^XÉ‘Î‚Ä‘B
- **XP[uİŒv**: ÌÚ‘É‚Î‰Â”\UIB
- **NCbNANVo[**: Mev[ghbv_EÜ‚Íƒ{^Å‘sBÎÛƒCX^XIÄ‘MB
- **_r[^r[Ø‘**: O[vA^OAvgRÊ‚Ìê‚½ê——Å‘CX^XÇ—B
- **ffpl**: Ú‘eXgAİ’ñ¦B

### 2.6 ffx@\iCX^XPÊ‚Å“Æ—ffj
- **lbg[NaÊŠmF**: IPBA|[gJó‹µA[eBOÂBICX^XÌÚ‘ffB
- **Â‹`FbNXg**: æ‚­\~XoAÄ‚ñ¦BCX^XÆ‚Ìİ’ØB
- **Ú‘h_E**: eCX^XÌÔ‘JÚAÅIG[nÅŠmFB
- **ZbgAbvKCh**: NÉÇ‚EBU[hÅÂ‹ğ®”B
- **lbg[NAiCU**: IPBA|[gJó‹µA[eBOÂBICX^XÌÚ‘ffB
- **Â‹`FbNXg**: æ‚­\~XoAÄ‚ñ¦BCX^XÆ‚Ìİ’ØB
- **Ú‘h_E**: eCX^XÌÔ‘JÚAÅIG[nÅŠmFB
- **ZbgAbvKCh**: NÉÇ‚EBU[hÅÂ‹ğ®”B

---

## 3. VXe\

### 3.1 fBNg\

#### 3.1.1 ÊMCX^XÌŠTO
{AvÉ‚ÄA**1tH_ = 1ÊMCX^X = 1\PbgÚ‘(IP:Port) = 1OuEAvÍ‹[**Æ‚Î‰ÖŒW{İŒvÆ‚BeCX^XÍˆÈ‰Ì—vfÆ—Ä•ÛAÌƒCX^XÆŠSÉ•ê‚½Ô‚Å“ì‚·:

- **Ú‘İ’**: TCP/UDPANCAg/T[o[[hAoChIP:PortAÚ‘IP:Port
- **ViIs**: MV[PXAÒ‹@EE[vAÏXR[v
- **dev[g**: f[^oNA[AQuickSendXbg
- **\v**: X[vbg/CeVAo[XgMİ’
- **s**: MOAffÊAv|[g

ÌİŒvÉ‚A1PCÅ•ÌŠOuğ“¯É–Í‹[Å‚AuAÍ’IÈƒXe[^XMAuBÍ—v^AuCÍ×ƒXg[Æ‚Ù‚È‚Ué•‘ssÅ‚B

#### 3.1.2 tH_\
`Instances/` zÉ”CÓ‚ÌƒtH_Å’ÊMCX^XzuBtH_ÍÊ‚â‚·ÌiuEprÈ‚ÇjRÉİ’Å‚AAvÍƒtH_Ì‘İ‚mÄFBtH_Ç‰ÎVÈƒCX^XÇ‰AíœÎ‘Éˆê——çœOiFileSystemWatcherÅŠÄjB
```
TcpDebugger/
 TcpDebugger.ps1              # CXNvgiGUIGg[|Cgj
 DESIGN.md                    # {İŒv
 README.md                    # gp@
 Modules/                     # W[Q
    ConnectionManager.ps1        # Ú‘Ç—
    TcpClient.ps1               # TCPNCAg
    TcpServer.ps1               # TCPT[o[
    UdpCommunication.ps1        # UDPÊM
    ScenarioEngine.ps1          # ViIsGW
    MessageHandler.ps1          # d
    AutoResponse.ps1            # 
    QuickSender.ps1             # f[^oN & NbNM
    InstanceManager.ps1         # _O[vÇ—
    NetworkAnalyzer.ps1         # Â‹ff
 Config/                      # Êİ’EftHgev[g
    defaults.psd1                # lXibvVbg
 Instances/                   # ÊMCX^XtH_QiÅ“IFj
    WebServer-Sim/               # CÓ‚ÌƒtH_iuÊ–j
       instance.psd1            # CX^Xİ’iIDA\AÚ‘p[^j
       scenarios/               # ÌƒCX^XpViI
          startup.csv
          auto_response.csv
       templates/               # ÌƒCX^Xpdev[g
          messages.csv
       logs/                    # MOij
       reports/                 # \v|[gij
    PLC-Controller/              # Ê‚ÌƒCX^X
       instance.psd1
       scenarios/
          periodic_poll.csv
       templates/
           plc_commands.csv
    LoadTest-Client01/           # ×pCX^X
        instance.psd1
        scenarios/
            burst_send.csv
 Scripts/                     # JX^XNvg
    custom_handlers.ps1
 UI/                          # UI`
     MainForm.ps1                # WinFormstH[`iKvÉ‰C#R[hAdd-TypeÅ–ßİj
```

#### 3.1.3 CX^XoEÇ—[
- **Å\**: `Instances/<CÓƒtH_>/instance.psd1` İ‚ÎƒCX^XÆ‚Ä”FB
- **CX^XID**: `instance.psd1`  `Id` vpeBÅˆÓÊiwèÍƒtH_ç©jB
- **\**: `DisplayName` vpeBUI\pÌ–Ì‚İ’Â”\iwèÍƒtH_gpjB
- **tH_Ä**: FileSystemWatcher `Instances/` zÌ’Ç‰EíœEl[mAUIÖƒA^CfB
- **İ’Ì—Dæ‡**: 
  1. CX^XtH_Ìİ’t@Ci`scenarios/`, `templates/`j
  2. `Config/defaults.psd1` ÌƒVXeftHg
- **Æ—Û**: eCX^XÍ“ÆÌƒXbhEÏXR[vEÔŠÇ—ACX^XÌ“É‰e^È‚B
- **OE|[g**: eCX^XtH_ÉÛ‘AtH_ÆƒRs[é‚±Æ‚ÅŠÂ‹ÚsEobNAbvÂ”\B

### 3.2 W[\

#### 3.2.1 ConnectionManageriÚ‘Ç—j
- Ú‘ÌˆêŒ³Ç—
- Ú‘CX^XÌEj
- Xe[^XÄ

#### 3.2.2 TcpClient/TcpServer
- TCPÚ‘ÌŠmEØ’f
- ñ“¯ŠM
- CxgÊ’miÚ‘/Ø’f/Mj

#### 3.2.3 UdpCommunication
- UDP\PbgÌŠÇ—
- M

#### 3.2.4 ScenarioEngine
- CSVViIÌ“Ç‚İİE
- ViIs
- ÏÇ—Eu

#### 3.2.5 MessageHandler
- dÌƒGR[h/fR[h
- tH[}bgÏŠiHEX, ASCII, etc.j
- of[V

#### 3.2.6 AutoResponse
- Mp^[}b`O
- [Ç—
- ev[gKp

#### 3.2.7 QuickSender
- f[^oNiev[g^t@C^f[^j[hAQuickPadL[giXbgÔjÖƒoCh
- NbNMAÅŒÌ‘MÄsAO[vM
- MÌ•ÛÆÄ‘

#### 3.2.8 InstanceManager
- Ú‘_O[vE^OÅ•
- êŠ‡iÚ‘Jn/~AMAViIsj
- _r[pf[^fÌ’

#### 3.2.9 NetworkAnalyzer
- Ú‘OffiPingA|[gaÊA[eBOmFj
- İ’`FbNXg
- G[ÌƒRh

### 3.3 WJA[LeN`
```

 Presentation Layer                          
  - WinForms MainForm (Quick Send, Logical View) 
  - UserControls / Shared Styles (Panel/ControlCu) 

           (Data binding / Commands)

 Orchestration Layer                         
  - ConnectionManager                        
  - ScenarioEngine                           
  - InstanceManager                          

           (Events / Pipelines)

 Service Layer                               
  - TcpClient / TcpServer / UdpCommunication 
  - QuickSender / AutoResponse               
  - NetworkAnalyzer                          

           (I/O, OS API, Files)

 Infrastructure Layer                        
  - Config & DataBank Loader                 
  - Logging                                  
  - Resource Monitors                        

```

- **Ó–**: UIÍƒf[^oCfBOÌ‚İ‚SAsOrchestrationwÖˆÏBÊM^ffÆ‚åˆServicewSAt@CÇ‚İiInfrastructurewÅ‹Ê‰B
- **Cxgì“®**: OrchestrationwPowerShellCxgUIÖÔ‚Ê’mBServicewÍƒCxgÎ‚Ì‚İ‚sAUIXbhÉ’ÚGÈ‚B
- **g**: VvgRÍ‹@\ServicewÌƒW[Ç‰ÅAUI/OrchestrationÍÅCÅÏ‚ŞB

### 3.4 Xbh\iThread Topologyj
- **UI Thread**: WinFormsÌƒbZ[W[vi`System.Windows.Forms.Application.Run`jB[U[Æ•\XVSB
- **Connection Threads**: Ú‘Æ‚1XbhmÛ‚Añ“¯ŠMÆ‘MsBeCX^XÍ“Æ—\[XÌ‚İ‘ì‚·é‚½ßAbNsvB
- **Scenario Threads**: ViIPÊ‚ÅƒXbhNAXebvsÒ‹@ğ§ŒBLZÍƒtOÅŠÇ—B
- **Diagnostics Thread**: NetworkAnalyzerpBPing/Port`FbNñ“¯ŠÅsAÊ‚OrchestrationwÖ’Ê’mB
- **Shared Data Structures**: `Hashtable`isynchronizedjÅÚ‘Ô‚LBUIXV`Control.Invoke`î‚µfBXpb`ÅˆÑmÛB

**Xbh**: eÊMCX^XÍpXbhÅ“ì‚µAÆÌƒobt@EÏEÔ‚Ì‚İ‚ğ‘€BCX^XÌƒ\[XÉ‚ÍˆØGÈ‚ßAbN~[ebNXÍ•svB

### 3.5 Cxg^bZ[Wt[
| Cxg | ÎŒ | M | e |
| --- | --- | --- | --- |
| `Connection.StatusChanged` | Connection Thread | InstanceManager, UI | Ú‘ÔEG[R[h |
| `Scenario.StepProgress` | ScenarioEngine | UI, Logging | İƒXebvAiAÏXibvVbg |
| `QuickSend.Requested` | UI{^ | QuickSender | DataID, ÎÛÚ‘/O[v |
| `Diagnostics.Result` | NetworkAnalyzer | UI | èŒ‹ÊAANV |

- **bZ[WoX**: PowerShell`Register-EngineEvent`{JX^Cxgğ—˜—pAXbhÔ‚Å‘aÉ’ÊMB

### 3.6 ÔEİ’Ç—
- **Immutable Config**: N`instance.psd1`Ç‚İİA`ConfigSnapshot`Æ‚Ä•ÛBÏXÍuÄ“Ç‚İİvÅƒo[WAbvACxgÅŠeW[Ö“`dB
- **Runtime State Store**: Ú‘ÔAViIsó‹µ‚`StateStore`isynchronized HashtablejÉWBUIStoreÉƒoChAOOAPI\[XQÆ‚B
- **Data Persistence**: DataBankDiagnosticsÍŠeCX^XtH_É•Û‘B
- **OÛ‘**: [U[IÉuOÛ‘vsê‡Ì‚İƒt@CoÍit@CÍƒ[U[wj

### 3.7 g|Cg
- **Plug-in Loader**: `Scripts/`zPS1[hA`ExportedFunctions.psd1`ÉÖScenarioEngineQuickSenderÄ‚ÑoÂ”\B
- **Protocol Adapter**: VÊMi`Modules/Adapters/<Protocol>.ps1`Ç‰AConnectionManagerÌƒt@NgÉ“o^é‚¾Å—pÂ”\B
- **Data Transformer**: MessageHandler`IMessageTransformer`ÌƒC^[tF[X`ABase64AkÈ‚Ç‚`F[Â”\B
- **UI Custom Pane**: MainForm`Panel`v[Xz_pÓ‚AUserControlÇ‰tH[Ö‚\É‚B

### 3.8 fvC^^pf
- **Pzz**: `TcpDebugger.ps1``Modules/`zğ“¯ƒfBNgÉ”zué‚¾Å“BPowerShell 5.1Èã‚ªÎ’Ç‰CXg[svB
- **CX^XÇ—**: `Instances/`zÉƒtH_Ç‰é‚¾ÅVKCX^Xì¬B
- ****: ÊÍƒ[UÅsB|[gJt@CAEH[İ’Ì‚İiPowerShellÊ“rNB
- **Oo**: [U[KvÉuOGNX|[gv{^Å–IÉ•Û‘iÛ‘È‚j

### 3.9 ICX^XÇ—

#### 3.9.1 CX^XCtTCN
```
ì¬    Ú‘  ANeBu  Ø’f  j
                               
   Ä—pv[           ÄÚ‘
```

#### 3.9.2 \[XÇ—í—ª
- **Runspacev[**: Å‘50 Runspacev[Aì¬/jÌƒI[o[wbhíŒ¸
- **ConcurrentDictionary**: XbhZ[tÈÚ‘Ç—Å‹Ô‚
- **Iíœ**: [U[UIÜ‚APIíœsÜ‚Å•ÛiíœÈ‚j

#### 3.9.3 ob`
|  |  | j |
|------|------|-------------------|
| êŠ‡Ç‰ | CSVC|[gAtH_Rs[ | tH_Ç‰ÅF |
| êŠ‡Ú‘ | IÚ‘ğ“¯Jn | eCX^XÌƒXbhN |
| êŠ‡íœ | O[v/^OPÊ‚Å‚Ìíœ | tH_íœÅ‘É”f |
| êŠ‡M | Ú‘Ö‚Ì“f[^M | eXbhÖ‘MCxgğ”­‰ |

#### 3.9.4 UI
- **zXg**: DataGridzÉ‚è‘½ÌÚ‘Å‚X[YXN[
- **f[^oCfBO**: `BindingList`{`BindingSource`gWinFormsWoCfBO
- **vOX\**: Ú‘Ì‘ìÍio[\
- **obNOEh**: Ú‘Í•ÊƒXbhÅsAUIubNÈ‚

#### 3.9.5 IÚ‘Ç‰API
```powershell
# PÚ‘Ç‰
$conn = $Global:ConnectionManager.AddConnection(@{
    Name = "web-server-01"
    Protocol = "TCP"
    RemoteIP = "192.168.1.100"
    RemotePort = 8080
    Group = "WebServers"
})

# ob`Ç‰iev[g20Âj
$template = @{
    BaseName = "load-test"
    Protocol = "TCP"
    RemoteIP = "192.168.1.200"
    RemotePort = 9000
    Group = "LoadTest"
}
$connections = $Global:ConnectionManager.AddConnectionBatch($template, 20)
#  load-test_1 ~ load-test_20 

# CSVC|[g
Import-Csv "new_connections.csv" | ForEach-Object {
    $Global:ConnectionManager.AddConnection(@{
        Name = $_.Name
        Protocol = $_.Protocol
        RemoteIP = $_.RemoteIP
        RemotePort = $_.RemotePort
        Group = $_.Group
    })
}

# Ú‘Ìíœ
$Global:ConnectionManager.RemoveConnection("web-server-01")

# O[vPÊ‚Åíœ
$removed = $Global:ConnectionManager.RemoveConnectionsByGroup("LoadTest")
Write-Host "$removed connections removed"
```

---



### 3.10 MCxgpCvC

- TcpClient/TcpServer/UdpCommunication ÌM[vÅ‚ÍAMÏ‚İƒoCg ConnectionContext.RecvBuffer É’Ç‹LÂ‚ÂAÚ‘Æ‚ Invoke-ConnectionAutoResponse Ä‚ÑoÆ‚Å‘É‰İ‚B

- AutoResponse.ps1  ReceivedRuleEngine.ps1  CSV  AutoResponse/OnReceived/Unified/Legacy Ê‚AResponseMessageFile (templates/)  ScriptFile (scenarios/onreceived/) KvÉ‰Ä“WJB


- OnReceivedHandler.ps1  OnReceivedLibrary.ps1  PowerShell XNvgMf[^Hâ‚·æ‚¤ÉAev[gÇ‚İİEoCgØ‚oEÏÇ—ESend-MessageData È‚Ç‚Ìƒwp[ñ‹Ÿ‚Ä‚B

- WinForms UI  DataGridView  AutoResponse/OnReceived/Periodic Send î‚µ Set-ConnectionAutoResponseProfile / Set-ConnectionOnReceivedProfile / Set-ConnectionPeriodicSendProfile Ä‚ÑoAMpCvCÌİ’sxXVÅ‚B



## 4. f[^tH[}bg

### 4.1 CX^Xİ’t@Ciinstance.psd1j
eCX^XtH_É”zuİ’t@CBÌƒt@CÌ‘İ‚É‚AvCX^XÆ‚Ä”FB

**: Instances/WebServer-Sim/instance.psd1**
```powershell
@{
    # CX^XÊqiÈ—ÍƒtH_ç©j
    Id = "web-srv-01"
    
    # UI\iÈ—ÍƒtH_gpj
    DisplayName = "WebT[o[Í‹[u"
    
    # Epr
    Description = "HTTPÊMpÌƒT[o[Í‹["
    
    # Ú‘İ’
    Connection = @{
        Protocol = "TCP"           # TCP/UDP
        Mode = "Server"           # Client/Server/Sender/Receiver
        LocalIP = "0.0.0.0"
        LocalPort = 8080
        RemoteIP = ""             # Server[hÅ‚Í•sv
        RemotePort = 0
    }
    
    # Nİ’
    AutoStart = $true            # AvNÉÚ‘
    AutoScenario = "startup.csv" # Ú‘ÉsViI
    
    # ^OEO[vi_r[Å‚Ì•Şj
    Tags = @("WebServer", "HTTP", "Test")
    Group = "WebServers"
    
    # GR[fBOİ’
    DefaultEncoding = "UTF-8"
    
    # \İ’
    Performance = @{
        EnableMetrics = $true
        SampleInterval = 1000    # ms
    }
}
```

**: Instances/PLC-Controller/instance.psd1**
```powershell
@{
    Id = "plc-ctrl-01"
    DisplayName = "PLCä‘•u"
    Description = "FAVXePLCÍ‹["
    
    Connection = @{
        Protocol = "TCP"
        Mode = "Client"
        LocalIP = "0.0.0.0"
        LocalPort = 0
        RemoteIP = "192.168.10.50"
        RemotePort = 502         # Modbus TCP
    }
    
    AutoStart = $false
    AutoScenario = "periodic_poll.csv"
    
    Tags = @("PLC", "Modbus", "FA")
    Group = "FactoryAutomation"
    
    DefaultEncoding = "ASCII"
}
```

1,LOOP,BEGIN,COUNT=3,LABEL=main,${MSG_HELLO}Æ‰3JÔ‚
2,SEND,${MSG_HELLO},,,HelloM
3,WAIT_RECV,TIMEOUT=5000,PATTERN=OK,,?@
4,SAVE_RECV,VAR_NAME=response,,,Mf[^???
5,SLEEP,1000,,,1b?@
6,SEND_HEX,48656C6C6F,,,HEXf[^M
7,SEND,${response},,,Mf[^??
8,CALL_SCRIPT,custom_check.ps1,,,JX^s
9,LOOP,END,LABEL=main,,[vI[

- `LOOP`: LOOPubN (BEGIN/END, COUNT, LABEL Î‰)
- `Name`: Ú‘Ê–
- `Protocol`: TCP/UDP
- `Mode`: Client/Server/Sender/Receiver
- `LocalIP`, `LocalPort`: [JoChİ’
- `RemoteIP`, `RemotePort`: [gÚ‘
- `AutoStart`: NÚ‘tO
- `ScenarioFile`: Ö˜AtViIt@C

### 4.2 ViIt@Ciscenarios/*.csvj
CX^XtH_É”zuBeCX^XpÌƒViI`B
```csv
Step,Action,Parameter1,Parameter2,Parameter3,Description
1,SEND,${MSG_HELLO},,,HelloM
2,WAIT_RECV,TIMEOUT=5000,PATTERN=OK,,Ò‹@
3,SAVE_RECV,VAR_NAME=response,,,Mf[^ÏÉ•Û‘
4,SLEEP,1000,,,1bÒ‹@
5,SEND_HEX,48656C6C6F,,,HEXf[^M
6,SEND,${response},,,Mf[^ğ‘—‚Ô‚
7,CALL_SCRIPT,custom_check.ps1,,,JX^s
8,LOOP,1,7,,,Xebv1-7[v
```

**ANV:**
- `SEND`: eLXgMiÏWJÂj
- `SEND_HEX`: HEXñ‘—M
- `SEND_FILE`: t@CeM
- `WAIT_RECV`: MÒ‹@i^CAEgAp^[}b`j
- `SAVE_RECV`: Mf[^ÏÉ•Û‘iñ‘—MÅ—pÂ”\j
- `SLEEP`: Ô‘Ò‹@
- `CALL_SCRIPT`: OXNvgs
- `SET_VAR`: Ïİ’
- `IF`: 
- `LOOP`: [v
- `DISCONNECT`: Ø’f
- `RECONNECT`: ÄÚ‘

### 4.3 dev[gitemplates/message_templates.csvj
CX^XtH_É”zuBeCX^XpÌ“dev[g`B
```csv
TemplateName,MessageFormat,Encoding
MSG_HELLO,Hello from ${HOSTNAME} at ${TIMESTAMP},ASCII
MSG_STATUS,STATUS ${SEQ}\n,UTF-8
MSG_BINARY,${HEX:AABBCCDD}${VAR:sequence},HEX
MSG_ECHO,${response},UTF-8
```

**Ï^Cv:**
- `${Ï}`: ÊÏiSAVE_RECVÅ•Û‘Mf[^j
- `${TIMESTAMP}`: ^CX^viyyyyMMddHHmmssj
- `${DATETIME:format}`: w
- `${RANDOM:min-max}`: _l
- `${SEQ:name}`: V[PXÔiCNgj
- `${HEX:value}`: HEXÏŠ
- `${CALC:expression}`: vZ

### 4.4 [iscenarios/auto_response.csvj
```csv
TriggerPattern,ResponseTemplate,Encoding,Delay,MatchType
^PING,PONG,ASCII,0,Regex
STATUS,OK ${TIMESTAMP},UTF-8,100,Exact
0x01020304,${MSG_ACK},HEX,0,Exact
```

**tB[h:**
- `TriggerPattern`: Mf[^Ìƒ}b`p^[
- `ResponseTemplate`: ev[giÏgpÂj
- `Encoding`: GR[fBO
- `Delay`: xi~bj
- `MatchType`: Regex/Exact/Contains
### 4.5 Mf[^oNidatabank.csvj
CX^XtH_É”zuBNCbNMpÌ“dev[gê——`B
```csv
DataID,Category,Description,Type,Content
STATUS,Basic,Xe[^XmF,TEXT,"STATUS\n"
QUERY,Basic,f[^v,TEXT,"QUERY\n"
PING,Health,aÊŠmF,HEX,50494E470D0A
SEQ_STATUS,Sequence,V[PXt^,TEMPLATE,SEQ=${SEQ:main}|TIME=${TIMESTAMP}
ECHO_BACK,Dynamic,Mf[^Ô‘,TEXT,${response}
```

**tB[h:**
- `DataID`: ev[gÊqiUI{^Ahbv_E\j
- `Category`: priBasic/Health/DynamicÈ‚Çj
- `Description`: Iy[^
- `Type`: TEXT/HEX/FILE/TEMPLATE È‚
- `Content`: f[^Ü‚Íƒev[giÏgpÂj

### 4.6 ff[İ’idiagnostics.psd1j
CX^XtH_É”zuBCX^XÅ—LÌff[`Â”\B
```powershell
@{
   checks = @(
      @{type = "ping"; target = '${REMOTE_IP}'; thresholdMs = 100}
      @{type = "port"; target = '${REMOTE_IP}'; port = 8080}
      @{type = "route"; destination = '${REMOTE_IP}'}
   )
   recommendations = @(
      @{code = "PING_FAIL"; message = "ÎÛ‘uÌ“d/lbg[NÔ‚mFÄ‚"}
      @{code = "PORT_CLOSED"; message = "|[g8080Â‚Ä‚Ü‚BÎÛ‘uÌƒT[rXNmFÄ‚"}
   )
}
```

**L[:**
- `checks`: sffXebviPing/Port/Routej
- `recommendations`: R[hÉ•RÃ‚AhoCXev[g
- Ï `${REMOTE_IP}` È‚Ç‚ÍÚ‘İ’è‚©ç©WJ

---

## 5. GUIİŒv

### 5.1 fUCRZvg
- **pd**: WinFormsÌ•WRg[pVvÅŒSUI
- **Fd**: é‚¢wiÉ“KxÈƒRgXgAdvÍFETCYÅ‹
- **IÈ‘**: hbv_EI{M{^ÌƒVvÈƒANVM
- **XP[u**: ÌÚ‘KwIÉŠÇ—AplTCYÂ”\
- **OCAEg**: iCX^Xê——jEipljEEiO/ffjÌ\

### 5.2 CEBhE\

#### p^[A: CX^Xê——x[Xij
```

 TCP Test Controller                  [Refresh][Connect All]  [][][~] 

 Instance List                                                           
 
   Name         Protocol Endpoint  Scenario     Status Action  
 
  WebServer-Sim TCP Svr :8080     [startup.csv] RUN  [Stop]   
  PLC-Ctrl-01   TCP Cli 192....:502[poll.csv  ] IDLE [Start]  
  LoadTest-01   TCP Cli 192....:9000[burst.csv ] ---- [Conn]   
  WebServer-02  TCP Svr :8081     [None      ] IDLE [Start]  
 
                                                                         
 Selected: WebServer-Sim                                    [Details]  

  Manual Send   Scenario Control   Diagnostics                      

 Scenario: startup.csv      Instance Log: WebServer-Sim                
 ? Step 3/12              
 Sending STATUS_OK         14:30:25  SEND STATUS_OK                
 ???????????? 67%         14:30:26  RECV ACK (64 bytes)           
                           14:30:27  SEND QUERY                    
 [? Run] [? Pause]                                                  
 [? Stop] [? Next Step]                                             
                                                                     
 Variables:                                                          
  response = "ACK"         
  seq = 3                                                              
                            [Clear Log] [Export Log]                   

 Ready | 3/4 connected | Selected: WebServer-Sim           v1.0.0      

```

**:**
- **CX^Xê——e[u**: ×‚Ä‚ÌƒCX^X1Ê‚Å”cBÔi=Ú‘A=Ø’fjAViIAsÔ‚ê——\B
- **CCViII**: esÉƒhbv_EzuAViIğ‘¦ÉØ‚Ö‚Â”\B
- **sIÅÚ×‘**: CX^XIÆAÉÚ×‘pliManual/Scenario/Diagnosticsj\B
- **ViIsÔ‚Ì‰Â**: StatusIDLE/RUN/ERROR\ACX^XÌ“só‹µ‚câ‚·B

#### p^[B: ^uØ‚Ö‚iÖˆÄj
```

 TCP Test Controller                                        [][][~]   
           
WebServer-Sim  PLC-Ctrl-01   LoadTest-01   WebServer-02  [+]       
           

 Instance: WebServer-Sim (Connected)                      [Disconnect]  
 Protocol: TCP Server | Endpoint: 0.0.0.0:8080                          

  Manual   Scenario   Diag Instance Log                            

 Scenario: [startup.csv ] 14:30:25  SEND STATUS_OK                
                           14:30:26  RECV ACK (64 bytes)           
 ? Step 3/12              14:30:27  SEND QUERY                    
 Sending STATUS_OK                                                   
 ???????????? 67%         
                                                                       
 [? Run] [? Pause]         Global Log (All Instances)                 
 [? Stop] [? Next Step]   
                           14:30:25 [WebServer-Sim]  SEND STATUS   
 Variables:                14:30:26 [PLC-Ctrl-01]  RECV 0x0102     
  response = "ACK"         14:30:27 [WebServer-Sim]  RECV ACK      
  seq = 3                  

 3/4 connected | Active: 2 scenarios running                v1.0.0      

```

**:**
- **^uØ‚Ö‚**: eCX^XÂ•Êƒ^uÅ•\BW1CX^Xğ‘€Å‚B
- **CX^XÆ‚ÌƒO**: Iğ’†ƒCX^XÌƒOÂ•Ê•\B
- **O[oO**: SCX^XÌƒOnÅ•\ASÌ‚Ì“cB

---

### 5.3 fUC: p^[AiCX^Xê——x[Xj

**Ì—pR:**
1. **ó‹µ”ce**: CX^XÌÔEViIsó‹µ‚1Ê‚Å”c
2. **ViIØ‚Ö‚v**: esÌƒhbv_EÅ‘ÉØ‚Ö‚AStart/Stop{^Å
3. **rÈ’P**: sÌ•ViI×‚ÄŠmFÂ”\
4. **XP[u**: 10?20CX^XÅ‚XN[Å‘Î‰Â”\

**Ú:**
- **DataGridView**: WinFormsDataGridViewgpAe`
  - 1: ÔƒACRi/ACellPaintingCxgÅ•`j
  - 2: NameiTextBoxColumnj
  - 3: ProtocoliTextBoxColumnj
  - 4: EndpointiTextBoxColumnj
  - 5: ScenarioiComboBoxColumnAICxgÅƒViIØ‚Ö‚j
  - 6: StatusiTextBoxColumnAF\j
  - 7: ActioniButtonColumnAStart/Stop/Connj
- **sICxg**: SelectionChangedCxgÅ‰ÌÚ×ƒplXV
- **CCANV**: ButtonColumnClickCxgÅÚ‘/Ø’f/ViIJn/~ğ§Œ

### 5.3 UIvfÚ

#### CX^Xê——e[uiDataGridViewj
- **Ô—i/j**: CellPaintingCxgÅFt~`
  - Î: Ú‘ÂƒViIs
  - Â: Ú‘ÅƒACh
  - O[: Ø’f
  - Ô: G[
- **Name**: CX^X\iinstance.psd1DisplayNamej
- **Protocol**: TCP/UDPAClient/Server/Sender/Receiver\
- **Endpoint**: [gIPÜ‚Íƒ[JoCh|[g\
- **ScenarioiComboBoxColumnj**: 
  - CX^XtH_scenarios/*.csv
  - [None]A[startup.csv]A[poll.csv]hbv_E\
  - IÏXScenarioEngineÖƒ[hwiÉ”fAJnÍ‚È‚j
- **Status**: IDLE / RUN / PAUSE / ERROR / ----iÚ‘j
  - wiFÅoIÉ‹ÊiRUN=ÎAERROR=Ôj
- **ActioniButtonColumnj**: 
  - Ú‘: [Connect]
  - Ú‘ÅƒViIs: [Start]iViIJnj
  - ViIs: [Stop]
  - G[: [Retry]

#### Ú×‘pli^uj

**Manual^uiè“®Mj:**
- **TemplateI**: ComboBoxDataBankê——\AJeSÊ‚ÉƒO[v
- **Preview**: ÏWJÏ‚İ‚Ì‘Mf[^TextBoxÅ•\EÒWÂ”\
- **EncodingI**: ASCII/UTF-8/Shift-JIS/HEXComboBoxÅ‘I
- **M{^**: 
  - [Send]: Iğ’†ƒCX^XÖ‘M
  - [Burst 10x]: 10AM
  - [Send to Group]: GroupÉ‘SCX^XÖ‘M

**Scenario^uiViIsj:**
- **sÔ•\**: 
  - İ‚ÌƒXebvÔ/Xebv
  - iiProgressBarj
  - oß
  - sÌƒANVeiTextBoxj
- **{^**: 
  - [? Run]: ViIJn
  - [? Pause]: ê~
  - [? Stop]: ~
  - [? Next Step]: 1Xebvs
- **Variables\**: İ‚Ì•ÏXR[vListViewÅ•\iÇ‚İpj

**Diagnostics^uiffj:**
- **ffs**: [Run Check]{^ÅffJn
- **Ê•\**: ListViewÅƒ`FbNÚ‚ÆƒXe[^Xi?OK/?NGj\
- **ANV**: TextBoxÅÄ‚\

#### CX^XOpliEj
- **ListView\**: Iğ’†ƒCX^XÌ‘M
  - 1: 
  - 2: iM/Mj
  - 3: f[^T}iÅ50j
  - 4: TCYibytesj
- **wiF**: Ms=ÂAMs=ÎAG[s=
- **Å‘100**: Ã‚Ì‚ç©íœ
- **{^**: 
  - [Clear Log]: İ‚ÌƒONA
  - [Export Log]: t@CÉ•Û‘iSaveFileDialogÅ•Û‘wj

#### O[vic[o[j
- **Group Filter**: ComboBoxÅ•\O[vIiAll/WebServers/LoadTestj
- **êŠ‡{^**: 
  - [Refresh]: CX^Xê——Ä“Ç‚İ
  - [Connect All]: tB^Ì‘SCX^XÚ‘
  - [Disconnect All]: tB^Ì‘SCX^XØ’f
  - [Start All Scenarios]: tB^Ì‘SCX^XÌƒViIJn

### 5.4 WinFormsj
- **tH[**: `UI/MainForm.ps1``System.Windows.Forms`pA`SplitContainer`ÅƒCAEgB
- **f[^oCfBO**: `BindingSource`{`BindingList`Ì—pAobNGh`StateStore`UIRg[ğ“¯ŠB
- **ñ“¯Š**: XbhÌ’Ê’m`Control.Invoke/BeginInvoke`UIXbhÖƒ}[VOB
- **Cxgì“®**: WinFormsCxgÅŠeRg[Ì‘B
- **WRg[**: TreeView, ComboBox, TextBox, Button, ListView, ProgressBarÌ•WRg[pB
- **CAEg**: `SplitContainer``TableLayoutPanel`3CAEgB`Dock`vpeBÅ‰Â•ÏƒTCYÎ‰B

### 5.5 fUCVXe

#### J[pbg
```
vC}:     #0078D4 (Microsoft Blue)
:           #107C10 (Success Green)
x:           #FFB900 (Warning Yellow)
G[:         #E81123 (Error Red)
wi:           #FFFFFF (White)
plwi:     #F3F3F3 (Light Gray)
{[_[:       #E1E1E1 (Border Gray)
eLXg:       #323130 (Dark Gray)
```

#### ^C|OtB
```
o:         Segoe UI Semibold 14pt
{^:         Segoe UI 10pt
{:           Segoe UI 9pt
R[h:         Consolas 9pt
```

#### ÔŠuETCY
```
{P:       8px Obh
pfBO:     8px / 16px
{^:     28px
ACRTCY: 16~16px
```

### 5.6 ANZVreB
- **L[{[hirQ[V**: Tab_IÉİ’è‚µAEnter/SpaceÅ‘Â”\B
- **V[gJbg**: Ctrl+SiÛ‘jACtrl+OiJjAF5itbVjÌˆÊƒV[gJbgT|[gB
- **tH[JX\**: L[{[htH[JXÉ˜gÅ–

---

## 6. t[

### 6.1 Nt[
```
1. TcpDebugger.ps1 s
2. W[Ç‚İ
3. WinFormstH[i`System.Windows.Forms.Application.Run`j
4. Instances/ tH_XLAinstance.psd1 Ç‚İ
5. AutoStart=trueÌÚ‘Jn
6. CCxg[vJn
```

### 6.2 Ú‘mt[iTCP Clientj
```
1. ConnectionManagerÚ‘İ’æ“¾AConnectionContextğ¶
2. TcpClient XbhNA[gzXgÖÚ‘s
3. Ú‘
    ÔXVCxgUIÖ”
    M[vJnAMf[^MessageHandlerÖˆÏ
    AutoStartViIScenarioEngineN
4. Ú‘s
    G[InstanceManagerÖ’Ê’m
    ÄÚ‘|VÉ]gC or [U[ÖƒG[
```

### 6.3 ViIst[
```
1. ScenarioEngineCSVÇ‚İİAActionpCvC\z
2. sJnÆAeXebvXbhÅ
3. SEND/SEND_HEXQuickSender APIoRÄ‘ÎÛÚ‘Ö‘M
4. WAIT_RECVIFÍMobt@^ÏXgAQÆ‚Ä”
5. SAVE_RECVÅMf[^ÏÉ•Û‘Añ‘—MÅ—pÂ”\
6. CALL_SCRIPTSET_VARÅŠOWbNÔXV{
7. iStepProgressCxgÆ‚UIÆƒOÖ’Ê’m
8. EfEG[ScenarioResultÆ‚InstanceManagerÉ•Ô‹p
```

### 6.4 t[
```
1. Connection XbhMf[^MessageHandlerÖ“n
2. AutoResponseW[[e[uğ‘–
3. }b`ê‡Íƒev[gWJDelayM
4. Ê‚ğ—š—Ö‹L^AKvÉ‰ScenarioEngineÖƒgK[Ô‘
5. }b`È‚ê‡ÍƒViIÒ‹@ÖˆÏ
```

### 6.5 NbNMt[iSend-Firstj
```
1. [U[hbv_EÅƒev[gIAM{^NbN
2. QuickSenderDataBankev[gÆ‘Mİ’æ“¾
3. MessageHandlerÅ•ÏWJEGR[hE`
4. ÎÛÚ‘Ü‚Í˜_O[vÌ‘ML[Ö“
5. Connection XbhMmFAXgAÖ‹L^
```

### 6.6 CX^XêŠ‡t[
```
1. [U[_r[ÅƒO[v/^OI
2. InstanceManagerÎÛÚ‘ê——ğ’Šo
3. viÚ‘/Ø’f/M/ViIJnjeÚ‘ÌƒXbhÖƒfBXpb`
4. eÚ‘ÌŒÊƒCxgWñ‚µAUIÉWÔi/sj\
```

### 6.7 lbg[Nfft[
```
1. ffplÅuRun Checkv{^NbN
2. NetworkAnalyzer XbhPing/Port/Route`FbNs
3. Ê‚XRAOAdiagnostics.psd1ÌANVKp
4. UIÖŒÊ•\AKvÉ‰Ä‘Îè‡
5. ÎÍuÄffvÅ“`FbNÄs
```

---

## 7. Zpdl

### 7.1 ÊM
- **TCP**: `System.Net.Sockets.TcpClient`, `TcpListener`
- **UDP**: `System.Net.Sockets.UdpClient`
- **ñ“¯Š**: `BeginReceive`/`EndReceive` Ü‚ `ReceiveAsync`
- **obt@TCY**: 8192oCgiÂ•Ïİ’Âj

### 7.2 XbhÇ—
- **CXbh**: WinForms UIXbhiApplication.Runj
- **Ú‘Xbh**: eÚ‘Æ‚ÉƒXbhiSystem.Threading.Threadj
- **ViIXbh**: ViIspXbh
- ****: `Hashtable.Synchronized()`Åƒf[^L
- **ffXbh**: NetworkAnalyzerobNOEhPing/Port`FbNs

**dv**: eCX^XÍ“Æ—\[XÌ‚İ‘ì‚·é‚½ßAbN@\Í•svB

### 7.3 G[nhO
- ×‚Ä‚Ì’ÊMtry-catchubN
- G[OGUIÉ•\
- ÄÚ‘WbNigCñ”AÔŠuİ’Âj

### 7.4 f[^i
- İ’t@C: PSD1`iPowerShellnbVe[uj
- O: [U[IÉuOÛ‘v{^Åo
- DataBank: eCX^XtH_CSVt@CÆ‚ÄŠÇ—

### 7.5 QuickSender
- DataBankt@C[hA`BindingList`UIÉƒoCh
- ev[gIDÆ‘Mf[^Ìƒ}bsOÇ—

### 7.6 InstanceManager
- eÚ‘PSCustomObjectÅƒbvAGroup/TagÇ‰
- O[voAêŠ‡API
- GUI`BindingSource`ÅÔ”zM

### 7.7 NetworkAnalyzer
- `Test-Connection`, `Test-NetConnection`, `Find-NetRoute`gİí‚¹ff
- ff[PSD1Å‹LqAANVev[g

### 7.8 OÇ—
- **Ox**: INFO/WARN/ERRORp
- **Oo**: [U[uOGNX|[gv{^Å–IÉ•Û‘it@CEÛ‘[U[wj
- **Û‘È‚**: Ú×ƒg[XKvÈê‡ÍŠOc[gp

---



### 7.9 mÌ‹ZpIÛ‘

- TcpClient.ps1  UdpCommunication.ps1 Å‚ Invoke-ConnectionAutoResponse ÌŒÄ‚ÑoÊ’uMOÉ‚AreceivedData Ï`Ì‚Ü‚Üsé‹°ê‚ª (TcpServer.ps1 ÍÊ’uÉ”zuÏ‚)B


- UI/MainForm.ps1  Periodic Send İ’Å‚Í– Get-InstancePath QÆ‚Ä‚AsÉ—OBConnection.Variables[InstancePath] Ä—pÅ‰CKvB

- ScenarioEngine.ps1  IF ANV (Invoke-IfAction) ÍŒxoÌƒX^uÅAğ”º‚ViIÜ‚sÅ‚È‚B

- OnReceived vt@C GUI Ø‚Ö‚Ä‚stbNİ‚È‚ßAUnified [oR Invoke-OnReceivedScript Ä‚Î‚P[XÈŠOÅ‚ÍŒÊ‚oÈ‚B



## 8. g

### 8.1 JX^XNvg
```powershell
# Scripts/custom_handlers.ps1
function CustomValidation {
    param($ReceivedData, $Connection)
    # JX^ØƒWbN
    if ($ReceivedData -match "ERROR") {
        # G[
        return $false
    }
    return $true
}
```

ViIÄ‚Ño:
```csv
Step,Action,Parameter1,Parameter2,Parameter3
10,CALL_SCRIPT,CustomValidation,$RECV_DATA,$CONN_NAME
```

### 8.2 vOC@\
- `Scripts/`zPS1t@CÇ‚İ
- `Ï‚İŠÖViIÄ‚ÑoÂ”\
- vOCAPIKÉ]

### 8.3 ÏVXeg
VÏ^CvÌ’Ç‰:
```powershell
# Modules/MessageHandler.ps1 
function Expand-Variables {
    # ${CUSTOM:xxx} p^[ÌÇ‰
}
```

---

## 9. ZLeBl

### 9.1 sÂ‹
- PowerShells|V[: RemoteSigned
- lbg[NANZXKv

> **pr**: {c[TCP/IPÊMpÌÅ‚AMê‚½lbg[NÂ‹Å‚ÌgpzBiÈƒZLeBvKvÈŠÂ‹Å‚ÍAKØ‚ÈƒANZXÆŠÄ{é‚±ÆB

---

## 10. ptH[}X

### 10.1 Å“K|Cg
- Êƒf[^MÌƒobt@O
- UIXVÌŠÔˆipxXVj
- OÛÌi100j
- NbNMÌƒfoEX

### 10.2 XP[reB
- Ú‘: 20?30Ú‘xz
- gp: Ú‘è”MB
- CPU: Êí < 5%
- êŠ‡äUIubNÈ‚æ‚¤ñ“¯Š

---

## 11. eXgj

### 11.1 PÌƒeXg
- eW[Ì“Æ—eXg
- QuickSender: ev[gWJAÏu
- InstanceManager: O[vì¬A^OtB^
- NetworkAnalyzer: Ping/PortÊ‚Ì”èƒWbN

### 11.2 eXg
- [J[vobNÊMeXg
- Ú‘eXg
- ViIseXgiSAVE_RECVÏßİ‘Mj
- DataBankQuickSenderÚ‘Ö‚ÌˆêŠ‡M

### 11.3 Â‹eXg
- @Æ‚ÌÚ‘eXg
- Ô‰Ò“eXg
- G[JoeXg
- 10?20Ú‘KÍ‚ÌƒO[vä

---

## 12. zzÆ‰^p

### 12.1 zzí—ª
- **|[^upbP[W**: PZIPt@CÅŠSÈsÂ‹zz
- **Ë‘ÖŒW**: PowerShell 5.1ÈiWindowsWjÌ‚
- **USBsÎ‰**: CÓ‚ÌƒhCusÂ”\AWXgË‘

### 12.2 pbP[W\
```
TcpDebugger/
 TcpDebugger.ps1              # CXNvg
 Modules/                     # W[Q
 Config/
    defaults.psd1            # ftHgİ’
 Instances/                   # ÊMCX^XtH_Q
    Example/                 # TvCX^X
        instance.psd1
        scenarios/
        templates/
 README.md
```

### 12.3 N@
```powershell
# {N
.\TcpDebugger.ps1

# Ü‚ÍAPowerShell ç’¼Ú‹N
powershell.exe -ExecutionPolicy Bypass -File ".\TcpDebugger.ps1"
```

### 12.4 zz@

#### X^hAzz
```powershell
# ZIPzz
#  TcpDebugger.zip

# WJÆs
Expand-Archive -Path "TcpDebugger.zip" -DestinationPath "C:\Tools\TcpDebugger"
cd "C:\Tools\TcpDebugger"
.\TcpDebugger.ps1
```

#### lbg[NLzz
```powershell
# T[o[: LtH_É”zu
Copy-Item -Path "TcpDebugger" -Destination "\\server\tools\TcpDebugger" -Recurse

# NCAg: Ús
\\server\tools\TcpDebugger\TcpDebugger.ps1
```

---

## 13. ÌŠg\

### 13.1 tF[Y1i{j- İ‚ÌİŒvÍˆ
- TCP/UDP{ÊM
- è“®M
- ViIGWiMf[^pÜ‚Şj
- WinFormsx[XGUI
- 1tH_=1CX^XÇ—
- ffx@\

### 13.2 tF[Y2i@\gj- 
- vgRÍƒvOC
- \@\iiperfİŠj
- è‚xÈƒViIDSL

---

## 14. Ql

### 14.1 ZpQl
- [PowerShell WinForms GUI Tutorial](https://learn.microsoft.com/powershell/scripting/samples/sample-gui)
- [.NET Socket Programming](https://docs.microsoft.com/dotnet/api/system.net.sockets)

### 14.2 Ö˜Ac[
- VSCode: XNvgÒW
- Excel/LibreOffice: CSVÒW

---

## t^A: Tvİ’t@C

Ú×‚ÈƒTvÍÉ•Ê“rì¬\B

---

****
- Version 1.0 (2025-11-15): Åì¬
- Version 1.1 (2025-11-15): vÆŠÈ‘f
  - 1tH_=1CX^XÉŒ
  - WinFormsÅŒIGUIÉ•ÏX
  - Xbh\ğ–¾ŠmibNsvj
  - iperfíœAff@\ÍˆÛ
  - ÍŒØ‚Í•svÆ–L
  - Mf[^p@\iSAVE_RECVjÇ‰
  - PowerShellPÌ‚Å‚ÌsÉŒ


****
- Version 1.0 (2025-11-15): Åì¬
---

**æ–‡æ›¸å±¥æ­´**
- Version 1.0 (2025-11-15): åˆç‰ˆä½œæˆ
- Version 1.1 (2025-11-15): è¦ä»¶æ•´ç†ã¨ç°¡ç´ åŒ–
  - 1ãƒ•ã‚©ãƒ«ãƒ€=1ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å³å¯†çµ±ä¸€
  - WinFormsã§ç¾å®Ÿçš„ãªGUIã«å¤‰æ›´
  - ã‚¹ãƒ¬ãƒƒãƒ‰æ§‹æˆã‚’æ˜ç¢ºåŒ–ï¼ˆãƒ­ãƒƒã‚¯ä¸è¦ï¼‰
  - iperfå‰Šé™¤ã€è¨ºæ–­æ©Ÿèƒ½ã¯ç¶­æŒ
  - å…¥åŠ›æ¤œè¨¼ã¯ä¸è¦ã¨æ˜è¨˜
  - å—ä¿¡ãƒ‡ãƒ¼ã‚¿æ´»ç”¨æ©Ÿèƒ½ï¼ˆSAVE_RECVï¼‰ã‚’è¿½åŠ 
  - PowerShellå˜ä½“ã§ã®å®Ÿè¡Œã«é™å®š


**æ–‡æ›¸å±¥æ­´**
- Version 1.0 (2025-11-15): åˆç‰ˆä½œæˆ
